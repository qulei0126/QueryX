# QueryX - SQLæŸ¥è¯¢å·¥å…·

åŸºäºPythonçš„SQLæŸ¥è¯¢å·¥å…·ï¼Œæ”¯æŒå¯¹Excelã€CSVå’ŒJSONæ–‡ä»¶è¿›è¡ŒSQLæŸ¥è¯¢ï¼Œå¹¶æä¾›å‹å¥½çš„GUIç•Œé¢ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒExcel(.xlsx/.xls/.xlsm)ã€CSV(.csv)å’ŒJSON(.json)æ–‡ä»¶
- **SQLæŸ¥è¯¢**ï¼šä½¿ç”¨DuckDBä½œä¸ºSQLå¼•æ“ï¼Œæ”¯æŒæ ‡å‡†SQLè¯­æ³•
- **å¯è§†åŒ–ç•Œé¢**ï¼šåŸºäºTkinteræ„å»ºçš„ç®€æ´ç›´è§‚çš„å›¾å½¢ç•Œé¢ï¼Œç»Ÿä¸€çš„åº”ç”¨å›¾æ ‡é£æ ¼
- **è¡¨ç»“æ„æµè§ˆ**ï¼šå¯é€šè¿‡ä¾§è¾¹æ å›¾æ ‡æ‰“å¼€è¡¨ç»“æ„é¢æ¿ï¼Œä»¥æ ‘å½¢å±•ç¤ºè¡¨å’Œå­—æ®µï¼Œæ”¯æŒè¡¨å­—æ®µæœç´¢
- **æ–‡ä»¶é¢„è§ˆ**ï¼šæŒ‰éœ€åŠ è½½æ–‡ä»¶é¢„è§ˆå†…å®¹ï¼Œæ”¯æŒæ‹–åŠ¨è°ƒæ•´é¢„è§ˆåŒºåŸŸå¤§å°
- **ç»“æœåˆ†é¡µ**ï¼šå¤§æ•°æ®é›†ç»“æœè‡ªåŠ¨åˆ†é¡µæ˜¾ç¤º
- **ç»“æœè¿‡æ»¤å’Œæ’åº**ï¼šåœ¨ç»“æœé¢æ¿ä¸­å¯ä»¥ç›´æ¥å¯¹æ•°æ®è¿›è¡Œç­›é€‰å’Œæ’åº
- **å¤šæ ¼å¼å¯¼å‡º**ï¼šæ”¯æŒå°†æŸ¥è¯¢ç»“æœå¯¼å‡ºä¸ºExcelã€CSVæˆ–JSONæ ¼å¼
- **æŸ¥è¯¢å†å²**ï¼šè‡ªåŠ¨ä¿å­˜æŸ¥è¯¢å†å²ï¼Œæ–¹ä¾¿é‡å¤ä½¿ç”¨
- **æ™ºèƒ½ä¾§è¾¹æ **ï¼šç±»ä¼¼IDEAçš„ä¾§è¾¹æ è®¾è®¡ï¼Œå¯ä»¥çµæ´»æ§åˆ¶é¢æ¿çš„æ˜¾ç¤ºå’Œéšè—
- **SQLç¼–è¾‘å¢å¼º**ï¼šè¯­æ³•é«˜äº®ã€è‡ªåŠ¨è¡¥å…¨ã€å‰ªåˆ‡/å¤åˆ¶/ç²˜è´´æ“ä½œå’Œä¸€é”®æ ¼å¼åŒ–SQLè¯­å¥
- **å³é”®èœå•åŠŸèƒ½**ï¼šæ–‡ä»¶åˆ—è¡¨æ”¯æŒå³é”®èœå•ï¼Œå¯å¿«é€Ÿé¢„è§ˆå’ŒæŸ¥è¯¢æ–‡ä»¶
- **ä¼˜åŒ–å¸®åŠ©ç³»ç»Ÿ**ï¼šæä¾›å¯æ»šåŠ¨çš„å¸®åŠ©å¯¹è¯æ¡†å’Œç¾è§‚çš„å…³äºç•Œé¢

## å®‰è£…æ–¹æ³•

### ç¯å¢ƒè¦æ±‚

- Python 3.6+
- ä¾èµ–åº“ï¼šduckdb, pandas, openpyxl, pillow, pyperclip, pygments, sqlparse

### å®‰è£…æ­¥éª¤

1. å…‹éš†æˆ–ä¸‹è½½æœ¬ä»“åº“

```bash
git clone https://github.com/qulei0126/QueryX.git
cd QueryX
```

2. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶

å¦‚æœå¸Œæœ›å°†åº”ç”¨æ‰“åŒ…ä¸ºç‹¬ç«‹çš„Windowså¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å‘½ä»¤è¡Œç›´æ¥æ‰“åŒ…

```bash
# å®‰è£…PyInstaller
pip install pyinstaller

# æ‰“åŒ…åº”ç”¨ï¼ˆå¸¦æœ‰åº”ç”¨å›¾æ ‡å’Œèµ„æºæ–‡ä»¶ï¼‰
pyinstaller --onefile --windowed --add-data "app/resources/*.ico;app/resources" --add-data "app/resources/*.py;app/resources" --icon="app/resources/icon.ico" --name="QueryX" main.py
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨specæ–‡ä»¶ï¼ˆæ¨èï¼‰

è¿™ç§æ–¹æ³•æä¾›æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œç¡®ä¿çª—å£å›¾æ ‡åœ¨æ‰“åŒ…åæ­£ç¡®æ˜¾ç¤ºï¼š

```bash
# ä½¿ç”¨é¡¹ç›®ä¸­æä¾›çš„specæ–‡ä»¶æ‰“åŒ…
pyinstaller QueryX.spec
```

æ‰“åŒ…åçš„å¯æ‰§è¡Œæ–‡ä»¶å°†ä½äº`dist`ç›®å½•ä¸­ï¼ŒåŒå‡»å³å¯è¿è¡Œï¼Œæ— éœ€å®‰è£…Pythonç¯å¢ƒã€‚

#### å¸¸è§é—®é¢˜è§£å†³

å¦‚æœæ‰“åŒ…åçš„ç¨‹åºçª—å£å›¾æ ‡ä¸æ­£ç¡®ï¼š
1. ç¡®ä¿ä½¿ç”¨äº†specæ–‡ä»¶æ‰“åŒ…æˆ–æ­£ç¡®åŒ…å«äº†æ‰€æœ‰èµ„æºæ–‡ä»¶
2. æ£€æŸ¥æ˜¯å¦æ­£ç¡®å¤„ç†äº†PyInstalleræ‰“åŒ…ç¯å¢ƒä¸‹çš„èµ„æºè·¯å¾„
3. å¯¹äºWindowsï¼Œå¯ä»¥å°è¯•ä½¿ç”¨`--win-private-assemblies`å‚æ•°

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨åº”ç”¨

```bash
python main.py
```

### åŸºæœ¬æ“ä½œæµç¨‹

1. **åŠ è½½æ•°æ®æ–‡ä»¶**
   - ç‚¹å‡»"æ·»åŠ æ–‡ä»¶"æŒ‰é’®é€‰æ‹©Excelã€CSVæˆ–JSONæ–‡ä»¶
   - æ”¯æŒåŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶
   - æ–‡ä»¶å°†æ˜¾ç¤ºåœ¨å·¦ä¾§æ–‡ä»¶é¢æ¿ä¸­
   - æ”¯æŒå³é”®ç‚¹å‡»æ–‡ä»¶ï¼Œé€‰æ‹©"é¢„è§ˆ"æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œæˆ–é€‰æ‹©"æŸ¥è¯¢"ç›´æ¥æŸ¥è¯¢æ‰€æœ‰è®°å½•

2. **ç•Œé¢æ“ä½œ**
   - å·¦ä¾§æœ‰ä¸€ä¸ªç±»ä¼¼IDEAçš„ä¾§è¾¹æ ï¼ŒåŒ…å«å¤šä¸ªåŠŸèƒ½æŒ‰é’®
   - "ğŸ“"æŒ‰é’®ï¼šæ˜¾ç¤º/éšè—æ–‡ä»¶é¢æ¿
   - "ğŸ“Š"æŒ‰é’®ï¼šæ˜¾ç¤º/éšè—è¡¨ç»“æ„é¢æ¿
   - "ğŸ“œ"æŒ‰é’®ï¼šæ˜¾ç¤º/éšè—å†å²é¢æ¿
   - ä¹Ÿå¯ä»¥é€šè¿‡"è§†å›¾"èœå•æ§åˆ¶å„é¢æ¿çš„æ˜¾ç¤ºå’Œéšè—

3. **è¡¨ç»“æ„æµè§ˆ**
   - ç‚¹å‡»"ğŸ“Š"æŒ‰é’®å¯æ‰“å¼€è¡¨ç»“æ„é¢æ¿ï¼Œä»¥æ ‘å½¢ç»“æ„å±•ç¤ºæ‰€æœ‰è¡¨åŠå…¶å­—æ®µ
   - æ¯ä¸ªè¡¨å’Œå­—æ®µéƒ½æœ‰ç›´è§‚çš„å›¾æ ‡æ ‡è¯†ï¼šè¡¨(ğŸ“Š)ã€ä¸»é”®(ğŸ”‘)ã€å¤–é”®(ğŸ”—)ã€æ™®é€šå­—æ®µ(ğŸ“)ã€æ•°å­—å­—æ®µ(ğŸ”¢)ã€æ—¥æœŸå­—æ®µ(ğŸ“…)
   - åŒå‡»è¡¨åå¯å±•å¼€/æ”¶èµ·è¡¨å­—æ®µåˆ—è¡¨
   - åŒå‡»å­—æ®µåå¯å°†è¡¨å.å­—æ®µåæ’å…¥åˆ°SQLç¼–è¾‘å™¨å…‰æ ‡å¤„
   - å¯ä½¿ç”¨æœç´¢æ¡†å¿«é€ŸæŸ¥æ‰¾è¡¨æˆ–å­—æ®µ
   - å³é”®ç‚¹å‡»è¡¨åå¯é€‰æ‹©"æ˜¾ç¤ºå‰10è¡Œ"ã€"æŸ¥è¯¢å…¨è¡¨"æˆ–"å¤åˆ¶è¡¨å"
   - å³é”®ç‚¹å‡»å­—æ®µåå¯é€‰æ‹©"å¤åˆ¶å­—æ®µå"

4. **ç¼–å†™SQLæŸ¥è¯¢**
   - åœ¨ä¸­å¤®ç¼–è¾‘å™¨ä¸­è¾“å…¥SQLæŸ¥è¯¢è¯­å¥
   - ä½¿ç”¨è¡¨åä½œä¸ºFROMå­å¥ï¼ˆè¡¨åä¸ºæ–‡ä»¶åï¼Œä¸å«æ‰©å±•åï¼‰
   - ä¾‹å¦‚ï¼š`SELECT * FROM employees WHERE salary > 10000`
   - å¯ä»¥ä½¿ç”¨"æ ¼å¼åŒ–SQL"æŒ‰é’®æˆ–å¿«æ·é”®Ctrl+Fè‡ªåŠ¨æ ¼å¼åŒ–SQLè¯­å¥
   - æ”¯æŒæ ‡å‡†çš„å‰ªåˆ‡(Ctrl+X)ã€å¤åˆ¶(Ctrl+C)ã€ç²˜è´´(Ctrl+V)æ“ä½œ

5. **æ‰§è¡ŒæŸ¥è¯¢**
   - ç‚¹å‡»"æ‰§è¡ŒæŸ¥è¯¢"æŒ‰é’®æˆ–æŒ‰Ctrl+Enter
   - ç»“æœå°†æ˜¾ç¤ºåœ¨ä¸‹æ–¹ç»“æœé¢æ¿ä¸­

6. **æµè§ˆå’Œå¯¼å‡ºç»“æœ**
   - ä½¿ç”¨åˆ†é¡µæ§åˆ¶æµè§ˆå¤§æ•°æ®é›†
   - ç‚¹å‡»"å¯¼å‡ºç»“æœ"æŒ‰é’®å°†ç»“æœä¿å­˜ä¸ºExcelã€CSVæˆ–JSONæ ¼å¼

7. **æŸ¥è¯¢å†å²**
   - å†å²æŸ¥è¯¢ä¼šè‡ªåŠ¨ä¿å­˜åœ¨å†å²é¢æ¿ä¸­
   - åŒå‡»å†å²è®°å½•æˆ–é€‰ä¸­åç‚¹å‡»"ä½¿ç”¨é€‰ä¸­"æŒ‰é’®å¯ä»¥é‡æ–°åŠ è½½æŸ¥è¯¢

## ç¤ºä¾‹æŸ¥è¯¢

å‡è®¾åŠ è½½äº†ä¸€ä¸ªåä¸º"employees.csv"çš„æ–‡ä»¶ï¼š

```sql
-- æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥
SELECT * FROM employees

-- æŸ¥è¯¢é«˜è–ªå‘˜å·¥
SELECT name, salary FROM employees WHERE salary > 10000

-- æŒ‰éƒ¨é—¨ç»Ÿè®¡å¹³å‡è–ªèµ„
SELECT department, AVG(salary) as avg_salary FROM employees GROUP BY department

-- è¿æ¥å¤šä¸ªè¡¨
SELECT e.name, e.salary, d.department_name 
FROM employees e JOIN departments d ON e.dept_id = d.id
```

## é¡¹ç›®ç»“æ„

```
QueryX/
â”œâ”€â”€ app/                  # åº”ç”¨ä¸»ç›®å½•
â”‚   â”œâ”€â”€ __init__.py          # åº”ç”¨åŒ…åˆå§‹åŒ–ï¼ŒåŒ…å«ç‰ˆæœ¬å’Œä½œè€…ä¿¡æ¯
â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py      # æ ¸å¿ƒæ¨¡å—åˆå§‹åŒ–ï¼Œå¯¼å‡ºæ ¸å¿ƒç±»
â”‚   â”‚   â”œâ”€â”€ file_handler.py  # æ–‡ä»¶å¤„ç†
â”‚   â”‚   â”œâ”€â”€ query_engine.py  # æŸ¥è¯¢å¼•æ“
â”‚   â”‚   â””â”€â”€ exporter.py      # å¯¼å‡ºåŠŸèƒ½
â”‚   â”œâ”€â”€ gui/              # GUIç•Œé¢æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py      # GUIæ¨¡å—åˆå§‹åŒ–ï¼Œå¯¼å‡ºç•Œé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ main_window.py   # ä¸»çª—å£
â”‚   â”‚   â”œâ”€â”€ file_panel.py    # æ–‡ä»¶é¢æ¿
â”‚   â”‚   â”œâ”€â”€ sql_editor.py    # SQLç¼–è¾‘å™¨
â”‚   â”‚   â”œâ”€â”€ result_panel.py  # ç»“æœé¢æ¿
â”‚   â”‚   â”œâ”€â”€ history_panel.py # å†å²è®°å½•é¢æ¿
â”‚   â”‚   â”œâ”€â”€ schema_panel.py  # è¡¨ç»“æ„é¢æ¿
â”‚   â”‚   â”œâ”€â”€ settings_dialog.py # è®¾ç½®å¯¹è¯æ¡†
â”‚   â”‚   â””â”€â”€ dialogs/         # å¯¹è¯æ¡†ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ __init__.py    # å¯¹è¯æ¡†æ¨¡å—åˆå§‹åŒ–ï¼Œå¯¼å‡ºå¯¹è¯æ¡†ç±»
â”‚   â”‚       â”œâ”€â”€ help_dialog.py # å¸®åŠ©å¯¹è¯æ¡†
â”‚   â”‚       â””â”€â”€ about_dialog.py # å…³äºå¯¹è¯æ¡†
â”‚   â”œâ”€â”€ resources/        # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py      # èµ„æºè·¯å¾„ç®¡ç†ï¼Œå¯¼å‡ºèµ„æºå¸¸é‡
â”‚   â”‚   â”œâ”€â”€ icon.ico         # åº”ç”¨å›¾æ ‡
â”‚   â”‚   â””â”€â”€ help_content.py  # å¸®åŠ©å†…å®¹æ–‡æœ¬
â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py      # å·¥å…·æ¨¡å—åˆå§‹åŒ–ï¼Œå¯¼å‡ºå·¥å…·å‡½æ•°
â”‚       â””â”€â”€ helpers.py       # è¾…åŠ©åŠŸèƒ½
â”œâ”€â”€ examples/             # ç¤ºä¾‹æ–‡ä»¶
â”œâ”€â”€ main.py               # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ requirements.txt      # ä¾èµ–åˆ—è¡¨
```

## è®¸å¯è¯

MIT License

## æ›´æ–°æ—¥å¿—